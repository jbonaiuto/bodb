{% extends "base_generic.html" %}
{% block extrahead %}
    <title>BODB - {% if form.instance.id%}Edit {{ form.instance.title }}{% else %}Add{% endif %} Prediction</title>
    <script type="text/javascript">
        animatedcollapse.addDiv('ssrData', 'fade=1');

        function validateForm()
        {
            var errors=0;

            clearSpan(document, 'span_errors');
            clearSpan(document, 'title_errors');
            errors+=validateField('title', 'Title', 'title_errors');
            clearSpan(document, 'description_errors');
            errors+=validateField('brief_description', 'Brief description', 'description_errors');
            var ssrErrors=validateInlineForm('predictionssr', ['ssr_title','ssr_brief_description'], ['Title','Brief description']);
            if(ssrErrors>0)
                animatedcollapse.show('ssrData');
            errors+=ssrErrors;

            return errors==0;
        }

        function save(isDraft)
        {
            if(validateForm())
            {
                document.getElementById('id_draft').value=isDraft;
                document.getElementById('predictionForm').submit();
            }
        }

        function deletePrediction()
        {
            if(confirm('Do you really want to delete the current entry?'))
            {
            {% if ispopup %}
                if(opener.document.getElementById('span_prediction_{{ form.instance.id }}')!=null)
                    clearSpan(opener.document, 'span_prediction_{{ form.instance.id }}');
            {% endif %}
                document.location.href='/bodb/prediction/{{form.instance.id}}/delete/{% if ispopup %}?_popup=1{% endif %}';
            }
        }
    </script>
{% endblock %}
{% block content %}
    <div id="detail">
        <h2>{% if form.instance.id%}Edit{% else %}Add{% endif %} Prediction</h2>
        <form id="predictionForm" method="post" action="">
            {% csrf_token %}
            <table class="tab_panel">
                <tr valign=top>
                    <td width=20%>{{ form.title.label_tag }}*</td>
                    <td width=200px>{{ form.title }} {%if form.instance.draft%}<font color=red>&lt;draft&gt;</font>{%endif%}</td>
                    <td class="myerrors"><span id="title_errors">{{ form.title.errors }}</span></td>
                </tr>
                <tr valign=top>
                    <td valign=top>{{ form.brief_description.label_tag }}*</td>
                    <td>{{ form.brief_description }}</td>
                    <td class="myerrors"><span id="description_errors">{{ form.brief_description.errors }}</span></td>
                </tr>
                <tr valign=top>
                    <td>{{ form.tags.label_tag }}</td>
                    <td>{{ form.tags }}</td>
                    {% if form.tags.errors %}<td class="myerrors">{{ form.tags.errors }}</td>{% endif %}
                </tr>
                {% if perms.bodb.public_prediction or user.is_superuser %}
                    <tr valign=top>
                        <td>{{ form.public.label_tag }}</td>
                        <td>{{ form.public }}</td>
                        {% if form.public.errors %}<td class="myerrors">{{ form.public.errors }}</td>{% endif %}
                    </tr>
                {% endif %}
                <tr>
                    <td colspan="3">
                        <span id="span_errors" class="myerrors"></span>
                    </td>
                </tr>
                <tr>
                    <td colspan=3 style="padding:0px">
                        <b class="b1f"></b><b class="b2f"></b><b class="b3f"></b><b class="b4f"></b>
                    </td>
                </tr>
                <tr class="section_header">
                    <td colspan=3>
                        Summaries of Simulation Results (SSRs) (<a href="javascript:animatedcollapse.toggle('ssrData')"><span id="ssrDataLabel">Show</span></a>)
                    </td>
                </tr>
                <tr>
                    <td colspan=3 style="padding:0px">
                        <b class="b4f"></b><b class="b3f"></b><b class="b2f"></b><b class="b1f"></b>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        {% include "bodb/ssr/ssr_list_detail.html" %}
                    </td>
                </tr>
            </table>
            <div class="myerrors">
                {{ form.errors }}
            </div>
            <br>
            {{ form.model }}
            {{ form.draft }}
            {{ form.collator }}
            <input class="btn" type="button" value="Save Draft" onclick="save(1)" onmouseover="this.className='btn btnhov'" onmouseout="this.className='btn'"/>&nbsp;
            {% if perms.bodb.save_prediction or user.is_superuser %}
                <input class="btn" type="button" value="Save" onclick="save(0)" onmouseover="this.className='btn btnhov'" onmouseout="this.className='btn'"/>&nbsp;
            {% endif %}
            {% if ispopup %}
                <input class="btn" type="button" value="Close" onclick="self.close();" onmouseover="this.className='btn btnhov'" onmouseout="this.className='btn'"/>&nbsp;
            {% endif %}
            {% if form.instance.id %}
                {% if not ispopup %}
                    <input class="btn" type="button" value="Cancel" onclick="document.location.href='/bodb/prediction/{{ form.instance.id }}/';" onmouseover="this.className='btn btnhov'" onmouseout="this.className='btn'"/>&nbsp;
                {% endif %}
            {% endif %}
        </form>
    </div>
{% endblock %}
